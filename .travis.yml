language: php

php:
  - "5.5"

env:
  - DB=mysql

mysql:
  database: drupal
  username: root

before_install:
  - pear channel-discover pear.drush.org

install:
  - pear install drush/drush
  - phpenv rehash

before_script:
  - echo 'sendmail_path = /bin/true' >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini
  - ./build.sh --quick
  - cd build/
  - drush si --db-url="mysql://root@127.0.0.1/drupal" invoicing -y
  - drush en simpletest -y

script:
  - drush test-run 'Invoicing - Access' --debug
  - drush test-run 'Invoicing - Business' --debug
  - drush test-run 'Invoicing - Client' --debug
  - drush test-run 'Invoicing - Line item' --debug
  - drush test-run 'Invoicing - Invoice' --debug
  - drush test-run 'Invoicing - Registration' --debug

notifications:
  irc: irc.freenode.org#pocomas
